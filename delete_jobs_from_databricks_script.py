import requests

DATABRICKS_URL = "https://dbc-0668e0d5-07bc.cloud.databricks.com"
TOKEN = "dapib49b04057228e3e837bba4af70064971"

headers = {"Authorization": f"Bearer {TOKEN}"}

# ✅ ADD all created job_ids here
job_ids = [
879593783988536, 784976030451617, 489652897604909, 669260004287164,
795840681656636, 480968463109844, 539111459999280, 102456181177914,
388834480578466, 354082262219373, 591736850751909, 95625247556382,
235015118815055, 275650525963677, 591914685154944, 74443555203025,
106531091349203, 296001717031185, 44249282284455, 343538348142137,
754850860487203, 402298982147754, 522528467858834, 328968027025600,
859344064254536, 404796650285407, 870695988028754, 76429006434122,
59366490850859, 231595239160641, 151911472410362, 820199356992473,
542004614910994, 753037476742972, 795583965909422, 653960678171362,
640494043390672, 6909886114564, 1062868541184635, 377798928693415,
43377142708200, 379409109978253, 944999061687090, 398493681268674,
262089925962353, 294591481044306, 1104402892630044, 286558362885674,
37434658769282, 1017591582914233, 794836334164008, 1076988324672450,
962968334443609, 512767662436389, 375301732656484, 70429802314364,
752573989854022, 93084283085668, 557679440157274, 1077569648590179,
991727878255056, 543380713420589, 189455151950450, 857014525955785,
1078545238779220, 740953097743853, 17961693147561, 696854163851800,
106238942330411, 378194323356303, 252282233503311, 920225568539840,
736910114459269, 360106038638004, 798588822754620, 650063946059517,
101087879168646, 999866643373529, 665992951908920, 177899503035589,
328882569791994, 829193421353425, 1080538182494264, 1010201769440722,
564874299563862, 827910637238540, 311889929723881, 383191070373243,
381365678381910, 297455130428771, 333947918527995, 254270625282260,
470540473427320, 983940582626183, 241819123569107, 224794904114676,
495452786384446, 143834110385596, 505389092473179
]

for job_id in job_ids:
    resp = requests.post(
        f"{DATABRICKS_URL}/api/2.1/jobs/delete",
        headers=headers,
        json={"job_id": job_id},
        verify=False
    )
    
    if resp.status_code == 200:
        print(f"✅ Deleted job {job_id}")
    else:
        print(f"❌ Failed {job_id} → {resp.text}")
